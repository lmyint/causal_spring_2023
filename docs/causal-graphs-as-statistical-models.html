<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 4 Causal Graphs as Statistical Models | STAT 451: Causal Inference</title>
  <meta name="description" content="This is the class website for Causal Inference (STAT 451) at Macalester College." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 4 Causal Graphs as Statistical Models | STAT 451: Causal Inference" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the class website for Causal Inference (STAT 451) at Macalester College." />
  <meta name="github-repo" content="lmyint/causal_spring_2023" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 4 Causal Graphs as Statistical Models | STAT 451: Causal Inference" />
  
  <meta name="twitter:description" content="This is the class website for Causal Inference (STAT 451) at Macalester College." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="study-designs.html"/>
<link rel="next" href="key-structures-in-causal-graphs.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="custom_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">STAT 451: Causal Inference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a>
<ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#required-references"><i class="fa fa-check"></i>Required references</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references-for-review"><i class="fa fa-check"></i>References for review</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#further-exploration"><i class="fa fa-check"></i>Further exploration</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="guiding-questions.html"><a href="guiding-questions.html"><i class="fa fa-check"></i>Guiding Questions</a></li>
<li class="part"><span><b>I Foundational Ideas</b></span></li>
<li class="chapter" data-level="1" data-path="motivation-and-review.html"><a href="motivation-and-review.html"><i class="fa fa-check"></i><b>1</b> Motivation and Review</a>
<ul>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#discussion-prompts"><i class="fa fa-check"></i>Discussion prompts</a>
<ul>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#considering-causes"><i class="fa fa-check"></i>Considering causes</a></li>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#sinful-saying-or-mandatory-mantra"><i class="fa fa-check"></i>Sinful saying or mandatory mantra?</a></li>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#sufficiency-and-necessity"><i class="fa fa-check"></i>Sufficiency and necessity</a></li>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#evaluating-evidence-for-causation-bradford-hill-criteria"><i class="fa fa-check"></i>Evaluating evidence for causation: Bradford Hill criteria</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exchangeability.html"><a href="exchangeability.html"><i class="fa fa-check"></i><b>2</b> Exchangeability</a>
<ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#learning-goals"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercises"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-5"><i class="fa fa-check"></i>Exercise 5</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-6-extra"><i class="fa fa-check"></i>Exercise 6 (Extra)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-7-extra"><i class="fa fa-check"></i>Exercise 7 (Extra)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="study-designs.html"><a href="study-designs.html"><i class="fa fa-check"></i><b>3</b> Study Designs</a>
<ul>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#learning-goals-1"><i class="fa fa-check"></i>Learning goals</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#exercises-1"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#peer-check-in"><i class="fa fa-check"></i>Peer check-in</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#exercise-2-1"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#exercise-3-1"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#extra"><i class="fa fa-check"></i>Extra</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Causal Graphs</b></span></li>
<li class="chapter" data-level="4" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html"><i class="fa fa-check"></i><b>4</b> Causal Graphs as Statistical Models</a>
<ul>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#learning-goals-2"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#simulating-data-in-r"><i class="fa fa-check"></i>Simulating data in R</a>
<ul>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#why-simulate"><i class="fa fa-check"></i>Why simulate?</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#simulation-functions-in-r"><i class="fa fa-check"></i>Simulation functions in R</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#simulating-data-from-graphssems"><i class="fa fa-check"></i>Simulating data from graphs+SEMs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#exercises-2"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#exercise-1-2"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#extra-1"><i class="fa fa-check"></i>Extra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html"><i class="fa fa-check"></i><b>5</b> Key Structures in Causal Graphs</a>
<ul>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#learning-goals-3"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercises-3"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercise-1-3"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercise-2-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercise-3-2"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercise-4-1"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#extra-2"><i class="fa fa-check"></i>Extra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html"><i class="fa fa-check"></i><b>6</b> Graphical Structure of Confounding</a>
<ul>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#learning-goals-4"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#exercises-4"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#exercise-1-4"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#exercise-2-3"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#exercise-3-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Homework</b></span></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html"><i class="fa fa-check"></i>Homework 1</a>
<ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#general-instructions"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-1"><i class="fa fa-check"></i>Part 1</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-2"><i class="fa fa-check"></i>Part 2</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-3"><i class="fa fa-check"></i>Part 3</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-4"><i class="fa fa-check"></i>Part 4</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-5"><i class="fa fa-check"></i>Part 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i>Homework 2</a>
<ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#general-instructions-1"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#revisions"><i class="fa fa-check"></i>Revisions</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#part-1-1"><i class="fa fa-check"></i>Part 1</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#part-2-1"><i class="fa fa-check"></i>Part 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html"><i class="fa fa-check"></i>Homework 3</a>
<ul>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#general-instructions-2"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#revisions-1"><i class="fa fa-check"></i>Revisions</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#clarifying-the-big-picture"><i class="fa fa-check"></i>Clarifying the big picture</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#the-smoking-birthweight-paradox"><i class="fa fa-check"></i>The smoking-birthweight paradox</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#exchangeability-computation"><i class="fa fa-check"></i>Exchangeability: Computation</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#exchangeability-explaining-via-causal-graphs"><i class="fa fa-check"></i>Exchangeability: explaining via causal graphs</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#simulation-d-separation-and-exchangeability"><i class="fa fa-check"></i>Simulation, d-separation, and exchangeability</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#study-designs-examples-of-applied-studies"><i class="fa fa-check"></i>Study designs: examples of applied studies</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#metacognitive-reflection"><i class="fa fa-check"></i>Metacognitive Reflection</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 451: Causal Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="causal-graphs-as-statistical-models" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Topic 4</span> Causal Graphs as Statistical Models<a href="causal-graphs-as-statistical-models.html#causal-graphs-as-statistical-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-2" class="section level2 unnumbered hasAnchor">
<h2>Learning Goals<a href="causal-graphs-as-statistical-models.html#learning-goals-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Apply the Causal Markov assumption to express the joint distribution of data.</li>
<li>Simulate data from causal graphs under linear and logistic regression structural equation models.</li>
<li>Formulate use cases of simulation to understand causal inference concepts</li>
</ul>
<p><br></p>
<p>Slides from today are available <a href="https://docs.google.com/presentation/d/1wfAzgLke1QJUHZsTomJ3nosAqhsvXUZTXLRqNOFlbeM/edit?usp=sharing">here</a>.</p>
<p><br><br><br></p>
</div>
<div id="simulating-data-in-r" class="section level2 unnumbered hasAnchor">
<h2>Simulating data in R<a href="causal-graphs-as-statistical-models.html#simulating-data-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>You can download a template RMarkdown file to start from <a href="template_rmds/04-graphs-models.Rmd">here</a>.</strong></p>
<div id="why-simulate" class="section level3 unnumbered hasAnchor">
<h3>Why simulate?<a href="causal-graphs-as-statistical-models.html#why-simulate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Simulation is a very powerful tool for understanding statistical ideas. We can simulate (generate) data where we know the true underlying distribution, and we can then see how statistical methods perform on this data. For example:</p>
<ul>
<li>Do 95% confidence intervals really contain the true population value in 95% of samples? When is this not true?</li>
<li>Does regression work to estimate causal effects when we have conditional exchangeability?</li>
</ul>
<p><br></p>
</div>
<div id="simulation-functions-in-r" class="section level3 unnumbered hasAnchor">
<h3>Simulation functions in R<a href="causal-graphs-as-statistical-models.html#simulation-functions-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R has functions to work with several probability distributions. For example, the following 4 functions work with the normal distribution:</p>
<ul>
<li><code>rnorm()</code>: Generate a <strong>r</strong>andom number from a normal distribution</li>
<li><code>pnorm()</code>: Tail <strong>p</strong>robability from a normal distribution</li>
<li><code>dnorm()</code>: Get <strong>d</strong>ensity value from a normal distribution</li>
<li><code>qnorm()</code>: Get a <strong>q</strong>uantile from a normal distribution</li>
</ul>
<p>There are <code>r</code>, <code>p</code>, <code>d</code>, and <code>q</code> functions for other distributions too (e.g., <code>runif()</code>, <code>rbinom()</code>.) We’ll primarily use <code>r</code> functions to generate random numbers.</p>
<p><strong><code>rbinom()</code></strong>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="causal-graphs-as-statistical-models.html#cb1-1" aria-hidden="true"></a><span class="co"># 4 different people each flip a fair coin once</span></span>
<span id="cb1-2"><a href="causal-graphs-as-statistical-models.html#cb1-2" aria-hidden="true"></a><span class="kw">rbinom</span>(<span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb1-3"><a href="causal-graphs-as-statistical-models.html#cb1-3" aria-hidden="true"></a></span>
<span id="cb1-4"><a href="causal-graphs-as-statistical-models.html#cb1-4" aria-hidden="true"></a><span class="co"># 4 different people flip unfair coins</span></span>
<span id="cb1-5"><a href="causal-graphs-as-statistical-models.html#cb1-5" aria-hidden="true"></a><span class="co"># First 2 flip a coin with P(Heads) = 0.9</span></span>
<span id="cb1-6"><a href="causal-graphs-as-statistical-models.html#cb1-6" aria-hidden="true"></a><span class="co"># Second 2 flip a coin with P(Heads) = 0.2</span></span>
<span id="cb1-7"><a href="causal-graphs-as-statistical-models.html#cb1-7" aria-hidden="true"></a><span class="kw">rbinom</span>(<span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>))</span>
<span id="cb1-8"><a href="causal-graphs-as-statistical-models.html#cb1-8" aria-hidden="true"></a></span>
<span id="cb1-9"><a href="causal-graphs-as-statistical-models.html#cb1-9" aria-hidden="true"></a><span class="co"># Write a command with rbinom() so that the result will definitively be 1,0,1</span></span></code></pre></div>
<p><strong><code>rnorm()</code></strong>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="causal-graphs-as-statistical-models.html#cb2-1" aria-hidden="true"></a><span class="co"># 5 numbers from a normal distribution with mean 10 and SD 2</span></span>
<span id="cb2-2"><a href="causal-graphs-as-statistical-models.html#cb2-2" aria-hidden="true"></a><span class="kw">rnorm</span>(<span class="dv">5</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb2-3"><a href="causal-graphs-as-statistical-models.html#cb2-3" aria-hidden="true"></a></span>
<span id="cb2-4"><a href="causal-graphs-as-statistical-models.html#cb2-4" aria-hidden="true"></a><span class="co"># 3 numbers from 3 different normal distributions</span></span>
<span id="cb2-5"><a href="causal-graphs-as-statistical-models.html#cb2-5" aria-hidden="true"></a><span class="co"># Means = 10, 100, 1000. SD = 1</span></span>
<span id="cb2-6"><a href="causal-graphs-as-statistical-models.html#cb2-6" aria-hidden="true"></a><span class="kw">rnorm</span>(<span class="dv">3</span>, <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>), <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb2-7"><a href="causal-graphs-as-statistical-models.html#cb2-7" aria-hidden="true"></a></span>
<span id="cb2-8"><a href="causal-graphs-as-statistical-models.html#cb2-8" aria-hidden="true"></a><span class="co"># Write a command with rnorm() so that the result will definitively be 10,20</span></span></code></pre></div>
<p><br></p>
</div>
<div id="simulating-data-from-graphssems" class="section level3 unnumbered hasAnchor">
<h3>Simulating data from graphs+SEMs<a href="causal-graphs-as-statistical-models.html#simulating-data-from-graphssems" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this course, we’ll simulate data that come from graphs and their corresponding structural equation models. We’ll step through how to simulate data that come from this causal graph.</p>
<p><img src="causal_manual_files/figure-html/04_dag_example-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Question:</strong> Using the Causal Markov Assumption, how can we express the joint distribution of this data?</p>
<p><br></p>
<p>Consider the structural equation model (SEM) below that is associated with our causal graph:</p>
<p><span class="math display">\[
\begin{align*}
Z &amp;\sim N(\mu_Z = 40, \sigma_Z = 5) \\
A &amp;\sim \mathrm{Binomial}(n = 1, p_A) \\
\qquad &amp;\log\left(\frac{p_A}{1-p_A}\right) = -1 + 0.05Z \\
Y &amp;\sim N(\mu_Y, \sigma_Y = 1) \\
\mu_Y &amp;= 30 + 5A + 2Z
\end{align*}
\]</span></p>
<ul>
<li><span class="math inline">\(Z\)</span> is an exogenous variable that follows a normal distribution with mean 40 and standard deviation 5.</li>
<li><span class="math inline">\(A\)</span> is binary (binomial/Bernoulli) with probability of success <span class="math inline">\(p_A\)</span>
<ul>
<li><span class="math inline">\(p_A\)</span> depends on <span class="math inline">\(Z\)</span> via a logistic regression model.</li>
</ul></li>
<li><span class="math inline">\(Y\)</span> is quantitative and follows a normal distribution.
<ul>
<li>The mean <span class="math inline">\(\mu_Y\)</span> depends on <span class="math inline">\(A\)</span> and <span class="math inline">\(Z\)</span> via a linear regression model.</li>
</ul></li>
</ul>
<p><br></p>
<p>Complete the code below to simulate data that follow this structural equation model.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="causal-graphs-as-statistical-models.html#cb3-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">451</span>) <span class="co"># For reproducibility</span></span>
<span id="cb3-2"><a href="causal-graphs-as-statistical-models.html#cb3-2" aria-hidden="true"></a></span>
<span id="cb3-3"><a href="causal-graphs-as-statistical-models.html#cb3-3" aria-hidden="true"></a><span class="co"># Sample size</span></span>
<span id="cb3-4"><a href="causal-graphs-as-statistical-models.html#cb3-4" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb3-5"><a href="causal-graphs-as-statistical-models.html#cb3-5" aria-hidden="true"></a></span>
<span id="cb3-6"><a href="causal-graphs-as-statistical-models.html#cb3-6" aria-hidden="true"></a><span class="co"># Simulate the Z variable</span></span>
<span id="cb3-7"><a href="causal-graphs-as-statistical-models.html#cb3-7" aria-hidden="true"></a>Z &lt;-<span class="st"> </span><span class="kw">rnorm</span>(?)</span>
<span id="cb3-8"><a href="causal-graphs-as-statistical-models.html#cb3-8" aria-hidden="true"></a></span>
<span id="cb3-9"><a href="causal-graphs-as-statistical-models.html#cb3-9" aria-hidden="true"></a><span class="co"># Simulate the A variable</span></span>
<span id="cb3-10"><a href="causal-graphs-as-statistical-models.html#cb3-10" aria-hidden="true"></a>log_odds_A &lt;-<span class="st"> </span><span class="dv">-1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>Z</span>
<span id="cb3-11"><a href="causal-graphs-as-statistical-models.html#cb3-11" aria-hidden="true"></a>odds_A &lt;-<span class="st"> </span><span class="kw">exp</span>(log_odds_A)</span>
<span id="cb3-12"><a href="causal-graphs-as-statistical-models.html#cb3-12" aria-hidden="true"></a>p_A &lt;-<span class="st"> </span>odds_A<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>odds_A)</span>
<span id="cb3-13"><a href="causal-graphs-as-statistical-models.html#cb3-13" aria-hidden="true"></a>A &lt;-<span class="st"> </span><span class="kw">rbinom</span>(?)</span>
<span id="cb3-14"><a href="causal-graphs-as-statistical-models.html#cb3-14" aria-hidden="true"></a></span>
<span id="cb3-15"><a href="causal-graphs-as-statistical-models.html#cb3-15" aria-hidden="true"></a><span class="co"># Simulate the Y variable</span></span>
<span id="cb3-16"><a href="causal-graphs-as-statistical-models.html#cb3-16" aria-hidden="true"></a>mean_Y &lt;-<span class="st"> </span><span class="dv">30</span> <span class="op">+</span><span class="st"> </span>?</span>
<span id="cb3-17"><a href="causal-graphs-as-statistical-models.html#cb3-17" aria-hidden="true"></a>noise_Y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb3-18"><a href="causal-graphs-as-statistical-models.html#cb3-18" aria-hidden="true"></a>Y &lt;-<span class="st"> </span>mean_Y <span class="op">+</span><span class="st"> </span>noise_Y</span>
<span id="cb3-19"><a href="causal-graphs-as-statistical-models.html#cb3-19" aria-hidden="true"></a></span>
<span id="cb3-20"><a href="causal-graphs-as-statistical-models.html#cb3-20" aria-hidden="true"></a><span class="co"># Store all simulated variables in a dataset called sim_data</span></span>
<span id="cb3-21"><a href="causal-graphs-as-statistical-models.html#cb3-21" aria-hidden="true"></a>sim_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Z, A, Y)</span></code></pre></div>
<p>After generating simulated data, it’s best to use plots and summary measures to make sure that marginal distributions and relationships between variables look sensible.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="causal-graphs-as-statistical-models.html#cb4-1" aria-hidden="true"></a><span class="co"># Explorations to check sensibility of simulated data</span></span></code></pre></div>
<p><br><br><br><br></p>
</div>
</div>
<div id="exercises-2" class="section level2 unnumbered hasAnchor">
<h2>Exercises<a href="causal-graphs-as-statistical-models.html#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You’ll need to install the <code>dagitty</code> package before getting started.</p>
<div id="exercise-1-2" class="section level3 unnumbered hasAnchor">
<h3>Exercise 1<a href="causal-graphs-as-statistical-models.html#exercise-1-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li><p>Write the joint distribution of the data from the causal graph below using the Causal Markov Assumption.</p>
<p><img src="causal_manual_files/figure-html/04_ex1-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Simulate data from the graph. You are free to choose your own structural equation model, but let <span class="math inline">\(Z\)</span>, <span class="math inline">\(W\)</span>, and <span class="math inline">\(Y\)</span> be quantitative. Let <span class="math inline">\(A\)</span> be binary. Use a sample size of 10,000 for your simulation. Use plots and summary measures to ensure that the simulated data have reasonable properties.</p></li>
<li><p>Based on the structural equation model you chose, what would you guess is the average causal effect <span class="math inline">\(E[Y^{a=1} - Y^{a=0}]\)</span>?</p></li>
<li><p>Let’s consider <em>simulating interventions</em> using your SEM. If you were to force all study units to receive a certain value of treatment (either 0 or 1), how do you think the causal graph would change?</p></li>
<li><p>Modify your simulation to reflect your thoughts from part d. Incorporate the code below into your simulation.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="causal-graphs-as-statistical-models.html#cb5-1" aria-hidden="true"></a><span class="co"># Scenario 1: Force all to be treated</span></span>
<span id="cb5-2"><a href="causal-graphs-as-statistical-models.html#cb5-2" aria-hidden="true"></a>A_force_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, n) <span class="co"># Repeat the number 1 n times</span></span>
<span id="cb5-3"><a href="causal-graphs-as-statistical-models.html#cb5-3" aria-hidden="true"></a><span class="co"># Scenario 2: Force all to be treated</span></span>
<span id="cb5-4"><a href="causal-graphs-as-statistical-models.html#cb5-4" aria-hidden="true"></a>A_force_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n) <span class="co"># Repeat the number 0 n times</span></span>
<span id="cb5-5"><a href="causal-graphs-as-statistical-models.html#cb5-5" aria-hidden="true"></a></span>
<span id="cb5-6"><a href="causal-graphs-as-statistical-models.html#cb5-6" aria-hidden="true"></a><span class="co"># The treated potential outcome Y^{a=1}</span></span>
<span id="cb5-7"><a href="causal-graphs-as-statistical-models.html#cb5-7" aria-hidden="true"></a>Y1 &lt;-<span class="st"> </span>? <span class="co"># something with A_force_1</span></span>
<span id="cb5-8"><a href="causal-graphs-as-statistical-models.html#cb5-8" aria-hidden="true"></a><span class="co"># The untreated potential outcome Y^{a=0}</span></span>
<span id="cb5-9"><a href="causal-graphs-as-statistical-models.html#cb5-9" aria-hidden="true"></a>Y0 &lt;-<span class="st"> </span>? <span class="co"># something with A_force_0</span></span>
<span id="cb5-10"><a href="causal-graphs-as-statistical-models.html#cb5-10" aria-hidden="true"></a></span>
<span id="cb5-11"><a href="causal-graphs-as-statistical-models.html#cb5-11" aria-hidden="true"></a><span class="co"># Estimate the average causal effect</span></span>
<span id="cb5-12"><a href="causal-graphs-as-statistical-models.html#cb5-12" aria-hidden="true"></a><span class="kw">mean</span>(?)</span></code></pre></div></li>
<li><p>Was your intuition from part b close to the ACE that you estimated in the simulation?</p></li>
</ol>
<p><br><br></p>
</div>
<div id="extra-1" class="section level3 unnumbered hasAnchor">
<h3>Extra<a href="causal-graphs-as-statistical-models.html#extra-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Try organizing the simulation code from today into general-purpose functions that can be used in subsequent simulations.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="study-designs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="key-structures-in-causal-graphs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
