<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 19 Instrumental Variables Analysis | STAT 451: Causal Inference</title>
  <meta name="description" content="This is the class website for Causal Inference (STAT 451) at Macalester College." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 19 Instrumental Variables Analysis | STAT 451: Causal Inference" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the class website for Causal Inference (STAT 451) at Macalester College." />
  <meta name="github-repo" content="lmyint/causal_spring_2023" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 19 Instrumental Variables Analysis | STAT 451: Causal Inference" />
  
  <meta name="twitter:description" content="This is the class website for Causal Inference (STAT 451) at Macalester College." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="interrupted-time-series.html"/>
<link rel="next" href="homework-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="custom_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">STAT 451: Causal Inference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a>
<ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#required-references"><i class="fa fa-check"></i>Required references</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references-for-review"><i class="fa fa-check"></i>References for review</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#further-exploration"><i class="fa fa-check"></i>Further exploration</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="guiding-questions.html"><a href="guiding-questions.html"><i class="fa fa-check"></i>Guiding Questions</a></li>
<li class="part"><span><b>I Foundational Ideas</b></span></li>
<li class="chapter" data-level="1" data-path="motivation-and-review.html"><a href="motivation-and-review.html"><i class="fa fa-check"></i><b>1</b> Motivation and Review</a>
<ul>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#discussion-prompts"><i class="fa fa-check"></i>Discussion prompts</a>
<ul>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#considering-causes"><i class="fa fa-check"></i>Considering causes</a></li>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#sinful-saying-or-mandatory-mantra"><i class="fa fa-check"></i>Sinful saying or mandatory mantra?</a></li>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#sufficiency-and-necessity"><i class="fa fa-check"></i>Sufficiency and necessity</a></li>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#evaluating-evidence-for-causation-bradford-hill-criteria"><i class="fa fa-check"></i>Evaluating evidence for causation: Bradford Hill criteria</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exchangeability.html"><a href="exchangeability.html"><i class="fa fa-check"></i><b>2</b> Exchangeability</a>
<ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#learning-goals"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercises"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-5"><i class="fa fa-check"></i>Exercise 5</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-6-extra"><i class="fa fa-check"></i>Exercise 6 (Extra)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-7-extra"><i class="fa fa-check"></i>Exercise 7 (Extra)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="study-designs.html"><a href="study-designs.html"><i class="fa fa-check"></i><b>3</b> Study Designs</a>
<ul>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#learning-goals-1"><i class="fa fa-check"></i>Learning goals</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#exercises-1"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#peer-check-in"><i class="fa fa-check"></i>Peer check-in</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#exercise-2-1"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#exercise-3-1"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#extra"><i class="fa fa-check"></i>Extra</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Causal Graphs</b></span></li>
<li class="chapter" data-level="4" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html"><i class="fa fa-check"></i><b>4</b> Causal Graphs as Statistical Models</a>
<ul>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#learning-goals-2"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#simulating-data-in-r"><i class="fa fa-check"></i>Simulating data in R</a>
<ul>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#why-simulate"><i class="fa fa-check"></i>Why simulate?</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#simulation-functions-in-r"><i class="fa fa-check"></i>Simulation functions in R</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#simulating-data-from-graphssems"><i class="fa fa-check"></i>Simulating data from graphs+SEMs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#exercises-2"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#exercise-1-2"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#extra-1"><i class="fa fa-check"></i>Extra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html"><i class="fa fa-check"></i><b>5</b> Key Structures in Causal Graphs</a>
<ul>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#learning-goals-3"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercises-3"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercise-1-3"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercise-2-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercise-3-2"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercise-4-1"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#extra-2"><i class="fa fa-check"></i>Extra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html"><i class="fa fa-check"></i><b>6</b> Graphical Structure of Confounding</a>
<ul>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#learning-goals-4"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#exercises-4"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#exercise-1-4"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#exercise-2-3"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#exercise-3-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphical-structure-of-selection-bias.html"><a href="graphical-structure-of-selection-bias.html"><i class="fa fa-check"></i><b>7</b> Graphical Structure of Selection Bias</a>
<ul>
<li class="chapter" data-level="" data-path="graphical-structure-of-selection-bias.html"><a href="graphical-structure-of-selection-bias.html#learning-goals-5"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-selection-bias.html"><a href="graphical-structure-of-selection-bias.html#exercises-5"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="graphical-structure-of-selection-bias.html"><a href="graphical-structure-of-selection-bias.html#exercise-1-5"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-selection-bias.html"><a href="graphical-structure-of-selection-bias.html#exercise-2-4"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-selection-bias.html"><a href="graphical-structure-of-selection-bias.html#exercise-3-4"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="the-smoking-birth-weight-paradox.html"><a href="the-smoking-birth-weight-paradox.html"><i class="fa fa-check"></i><b>8</b> The Smoking-Birth Weight Paradox</a>
<ul>
<li class="chapter" data-level="" data-path="the-smoking-birth-weight-paradox.html"><a href="the-smoking-birth-weight-paradox.html#our-task"><i class="fa fa-check"></i>Our Task</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="building-causal-graphs-for-applied-analyses.html"><a href="building-causal-graphs-for-applied-analyses.html"><i class="fa fa-check"></i><b>9</b> Building Causal Graphs for Applied Analyses</a>
<ul>
<li class="chapter" data-level="" data-path="building-causal-graphs-for-applied-analyses.html"><a href="building-causal-graphs-for-applied-analyses.html#learning-goals-6"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="building-causal-graphs-for-applied-analyses.html"><a href="building-causal-graphs-for-applied-analyses.html#exercises-6"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="building-causal-graphs-for-applied-analyses.html"><a href="building-causal-graphs-for-applied-analyses.html#data-context"><i class="fa fa-check"></i>Data context</a></li>
<li class="chapter" data-level="" data-path="building-causal-graphs-for-applied-analyses.html"><a href="building-causal-graphs-for-applied-analyses.html#collaborative-causal-graph-construction"><i class="fa fa-check"></i>Collaborative causal graph construction</a></li>
<li class="chapter" data-level="" data-path="building-causal-graphs-for-applied-analyses.html"><a href="building-causal-graphs-for-applied-analyses.html#incorporate-information-on-available-variables"><i class="fa fa-check"></i>Incorporate information on available variables</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Estimation</b></span></li>
<li class="chapter" data-level="10" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html"><i class="fa fa-check"></i><b>10</b> Applied Analysis: Regression</a>
<ul>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#learning-goals-7"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#analysis"><i class="fa fa-check"></i>Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#data-context-and-research-questions"><i class="fa fa-check"></i>Data context and research questions</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#part-1-finalize-adjustment-set"><i class="fa fa-check"></i>Part 1: Finalize adjustment set</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#part-2-exploratory-analysis"><i class="fa fa-check"></i>Part 2: Exploratory analysis</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#part-3-modeling"><i class="fa fa-check"></i>Part 3: Modeling</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#part-4-interpretation-and-discussion"><i class="fa fa-check"></i>Part 4: Interpretation and discussion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#simulation-study-planning"><i class="fa fa-check"></i>Simulation study planning</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html"><i class="fa fa-check"></i><b>11</b> Inverse Probability Weighting</a>
<ul>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#learning-goals-8"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#exercises-7"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#exercise-1-6"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#exercise-2-5"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#exercise-3-5"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#exercise-4-2"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#debrief"><i class="fa fa-check"></i>Debrief</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ipw-simulation.html"><a href="ipw-simulation.html"><i class="fa fa-check"></i><b>12</b> IPW: Simulation</a>
<ul>
<li class="chapter" data-level="" data-path="ipw-simulation.html"><a href="ipw-simulation.html#learning-goals-9"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="ipw-simulation.html"><a href="ipw-simulation.html#exercises-8"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="ipw-simulation.html"><a href="ipw-simulation.html#exercise-1-simulate"><i class="fa fa-check"></i>Exercise 1: Simulate</a></li>
<li class="chapter" data-level="" data-path="ipw-simulation.html"><a href="ipw-simulation.html#exercise-2-inverse-probability-weighting"><i class="fa fa-check"></i>Exercise 2: Inverse probability weighting</a></li>
<li class="chapter" data-level="" data-path="ipw-simulation.html"><a href="ipw-simulation.html#exercise-3-balance-checking"><i class="fa fa-check"></i>Exercise 3: Balance checking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html"><i class="fa fa-check"></i><b>13</b> Applied Analysis: IPW</a>
<ul>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#learning-goals-10"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#analysis-1"><i class="fa fa-check"></i>Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#data-context-and-research-questions-1"><i class="fa fa-check"></i>Data context and research questions</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#loading-data-and-packages"><i class="fa fa-check"></i>Loading data and packages</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#part-1-review-outcome-regression-results"><i class="fa fa-check"></i>Part 1: Review outcome regression results</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#part-2-propensity-score-modeling"><i class="fa fa-check"></i>Part 2: Propensity score modeling</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#part-3-modeling-with-ip-weights"><i class="fa fa-check"></i>Part 3: Modeling with IP weights</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#part-4-causal-graphs-and-missing-data"><i class="fa fa-check"></i>Part 4: Causal graphs and missing data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV New Research Questions</b></span></li>
<li class="chapter" data-level="14" data-path="time-varying-treatments-and-mediation-analysis.html"><a href="time-varying-treatments-and-mediation-analysis.html"><i class="fa fa-check"></i><b>14</b> Time-Varying Treatments and Mediation Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="time-varying-treatments-and-mediation-analysis.html"><a href="time-varying-treatments-and-mediation-analysis.html#learning-goals-11"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="time-varying-treatments-and-mediation-analysis.html"><a href="time-varying-treatments-and-mediation-analysis.html#exercises-9"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="time-varying-treatments-and-mediation-analysis.html"><a href="time-varying-treatments-and-mediation-analysis.html#exercise-1-7"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="time-varying-treatments-and-mediation-analysis.html"><a href="time-varying-treatments-and-mediation-analysis.html#exercise-2-6"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="time-varying-treatments-and-mediation-analysis.html"><a href="time-varying-treatments-and-mediation-analysis.html#exercise-3-6"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Sensitivity Analyses</b></span></li>
<li class="chapter" data-level="15" data-path="sensitivity-analyses-for-unmeasured-variables.html"><a href="sensitivity-analyses-for-unmeasured-variables.html"><i class="fa fa-check"></i><b>15</b> Sensitivity Analyses for Unmeasured Variables</a>
<ul>
<li class="chapter" data-level="" data-path="sensitivity-analyses-for-unmeasured-variables.html"><a href="sensitivity-analyses-for-unmeasured-variables.html#learning-goals-12"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="sensitivity-analyses-for-unmeasured-variables.html"><a href="sensitivity-analyses-for-unmeasured-variables.html#example-with-the-tipr-package"><i class="fa fa-check"></i>Example with the <code>tipr</code> package</a></li>
<li class="chapter" data-level="" data-path="sensitivity-analyses-for-unmeasured-variables.html"><a href="sensitivity-analyses-for-unmeasured-variables.html#discussion-questions"><i class="fa fa-check"></i>Discussion questions</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="causal-discovery.html"><a href="causal-discovery.html"><i class="fa fa-check"></i><b>16</b> Causal Discovery</a>
<ul>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#learning-goals-13"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercises-10"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-1-8"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-2-7"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-3-7"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-4-3"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Quasi-Experimental Designs</b></span></li>
<li class="chapter" data-level="17" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html"><i class="fa fa-check"></i><b>17</b> Regression Discontinuity</a>
<ul>
<li class="chapter" data-level="" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#learning-goals-14"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#exercises-11"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#context-and-setup"><i class="fa fa-check"></i>Context and setup</a></li>
<li class="chapter" data-level="" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#main-analysis"><i class="fa fa-check"></i>Main analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="interrupted-time-series.html"><a href="interrupted-time-series.html"><i class="fa fa-check"></i><b>18</b> Interrupted Time Series</a>
<ul>
<li class="chapter" data-level="" data-path="interrupted-time-series.html"><a href="interrupted-time-series.html#learning-goals-15"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="interrupted-time-series.html"><a href="interrupted-time-series.html#discussion"><i class="fa fa-check"></i>Discussion</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html"><i class="fa fa-check"></i><b>19</b> Instrumental Variables Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#learning-goals-16"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#exercises-12"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#exercise-1-9"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#exercise-2-8"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#exercise-3-8"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#exercise-4-4"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#extra-3"><i class="fa fa-check"></i>Extra!</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII Homework</b></span></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html"><i class="fa fa-check"></i>Homework 1</a>
<ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#general-instructions"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-1"><i class="fa fa-check"></i>Part 1</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-2"><i class="fa fa-check"></i>Part 2</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-3"><i class="fa fa-check"></i>Part 3</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-4"><i class="fa fa-check"></i>Part 4</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-5"><i class="fa fa-check"></i>Part 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i>Homework 2</a>
<ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#general-instructions-1"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#revisions"><i class="fa fa-check"></i>Revisions</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#part-1-1"><i class="fa fa-check"></i>Part 1</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#part-2-1"><i class="fa fa-check"></i>Part 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html"><i class="fa fa-check"></i>Homework 3</a>
<ul>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#general-instructions-2"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#revisions-1"><i class="fa fa-check"></i>Revisions</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#clarifying-the-big-picture"><i class="fa fa-check"></i>Clarifying the big picture</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#the-smoking-birthweight-paradox"><i class="fa fa-check"></i>The smoking-birthweight paradox</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#exchangeability-computation"><i class="fa fa-check"></i>Exchangeability: Computation</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#exchangeability-explaining-via-causal-graphs"><i class="fa fa-check"></i>Exchangeability: explaining via causal graphs</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#simulation-d-separation-and-exchangeability"><i class="fa fa-check"></i>Simulation, d-separation, and exchangeability</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#study-designs-examples-of-applied-studies"><i class="fa fa-check"></i>Study designs: examples of applied studies</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#metacognitive-reflection"><i class="fa fa-check"></i>Metacognitive Reflection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html"><i class="fa fa-check"></i>Homework 4</a>
<ul>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#general-instructions-3"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#revisions-2"><i class="fa fa-check"></i>Revisions</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#drawing-causal-graphs"><i class="fa fa-check"></i>Drawing causal graphs</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#general-workflow-for-regression-and-ipw"><i class="fa fa-check"></i>General workflow for regression and IPW</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#metacognitive-reflection-1"><i class="fa fa-check"></i>Metacognitive Reflection</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#final-project-proposal"><i class="fa fa-check"></i>Final Project Proposal</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html"><i class="fa fa-check"></i>Homework 5</a>
<ul>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#general-instructions-4"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#revisions-3"><i class="fa fa-check"></i>Revisions</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#project-work-reqd"><i class="fa fa-check"></i>Project Work (REQD)</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#metacognitive-reflection-reqd"><i class="fa fa-check"></i>Metacognitive Reflection (REQD)</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#sensitivity-analysis-for-unmeasured-confounding-reqd"><i class="fa fa-check"></i>Sensitivity analysis for unmeasured confounding (REQD)</a>
<ul>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#context"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#implementation-with-tipr"><i class="fa fa-check"></i>Implementation with <code>tipr</code></a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#interpret"><i class="fa fa-check"></i>Interpret</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#causal-discovery-reqd"><i class="fa fa-check"></i>Causal discovery (REQD)</a>
<ul>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#exercise-1-10"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#exercise-2-9"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#exercise-3-9"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#simulation-study-for-sensitivity-analyses"><i class="fa fa-check"></i>Simulation study for sensitivity analyses</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#learning-about-mediation-analysis"><i class="fa fa-check"></i>Learning about mediation analysis</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#randomized-experiments"><i class="fa fa-check"></i>Randomized experiments</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VIII Project</b></span></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html"><i class="fa fa-check"></i>Final Project</a>
<ul>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#project-options"><i class="fa fa-check"></i>Project Options</a>
<ul>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#option-1-data-analysis"><i class="fa fa-check"></i>Option 1: Data analysis</a></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#option-2-blog-posts"><i class="fa fa-check"></i>Option 2: Blog posts</a></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#option-3-learn-an-advanced-topic"><i class="fa fa-check"></i>Option 3: Learn an advanced topic</a></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#option-4-other"><i class="fa fa-check"></i>Option 4: Other</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#timeline"><i class="fa fa-check"></i>Timeline</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 451: Causal Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="instrumental-variables-analysis" class="section level1 hasAnchor" number="19">
<h1><span class="header-section-number">Topic 19</span> Instrumental Variables Analysis<a href="instrumental-variables-analysis.html#instrumental-variables-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-16" class="section level2 unnumbered hasAnchor">
<h2>Learning Goals<a href="instrumental-variables-analysis.html#learning-goals-16" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Explain the big picture ideas behind how IV studies work in terms of mimicking a randomized experiment</li>
<li>Evaluate the plausibility of IV assumptions within a data context</li>
</ul>
<p><br></p>
<p>Slides from today are available <a href="https://docs.google.com/presentation/d/1Y75rZZE0eYwwiuSUYn5mGZtDvIxilWEhBzeZhemS22g/edit?usp=sharing">here</a>.</p>
<p><br><br><br></p>
</div>
<div id="exercises-12" class="section level2 unnumbered hasAnchor">
<h2>Exercises<a href="instrumental-variables-analysis.html#exercises-12" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercise-1-9" class="section level3 unnumbered hasAnchor">
<h3>Exercise 1<a href="instrumental-variables-analysis.html#exercise-1-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In health services research, the distance that one lives from a specialty care provider is often considered as an instrument. In particular, studies have looked at the causal effect of high-level vs low-level neonatal intensive care units (high vs. low level NICUs) on birth outcomes. (High vs. low is differentiated by the amount of technology available and number of babies delivered per year.)</p>
<p>The instrument used in this setting was a <em>differential distance (excess travel time)</em>: travel time to the nearest high-level NICU <em>minus</em> travel time to the nearest low-level NICU. This instrument was binarized to be <span class="math inline">\(IV = 1\)</span> if this excess travel time was no more than 10 minutes, and <span class="math inline">\(IV = 0\)</span> otherwise. Distance to these health services is known to be a reflection of where mothers live which, in turn, is often a reflection of socioeconomic status indicators.</p>
<div id="part-a" class="section level4 unnumbered hasAnchor">
<h4>Part a<a href="instrumental-variables-analysis.html#part-a" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Evaluate the validity of differential distance as a (conditional) instrument by constructing a causal graph.</p>
<ul>
<li><p>Draw the causal graph.</p></li>
<li><p>Identify a conditioning set such that the instrument would be (conditionally) valid. It’s fine if this validity is only an approximate validity.</p></li>
<li><p>Evaluate the degree to which each of the 3 core instrumental assumptions (not the homogeneity or monotonicity assumptions) is satisfied. Make connections between d-separation and the graphical versions of these assumptions.</p></li>
</ul>
<p><br></p>
</div>
<div id="part-b" class="section level4 unnumbered hasAnchor">
<h4>Part b<a href="instrumental-variables-analysis.html#part-b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Under the monotonicity assumption, to whom does the causal effect estimated by IV generalize? Do you think this effect is of genuine interest in this setting?</p>
<p><br><br></p>
</div>
</div>
<div id="exercise-2-8" class="section level3 unnumbered hasAnchor">
<h3>Exercise 2<a href="instrumental-variables-analysis.html#exercise-2-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Some analysts have believed that it is possible to perform a hypothesis test to test the exclusion restriction assumption by regressing <code>Y ~ A + IV</code>. If they obtain a high p-value for the IV coefficient, that must mean that the exclusion restriction is met. However, even if the exclusion restriction is met, this test will likely not turn result in the correct conclusion.</p>
<p>Explain two things: (1) the intuition behind the <code>Y ~ A + IV</code> test and (2) why this test will not give the right result (using graph concepts).</p>
<p><br><br></p>
</div>
<div id="exercise-3-8" class="section level3 unnumbered hasAnchor">
<h3>Exercise 3<a href="instrumental-variables-analysis.html#exercise-3-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While randomized experiments are the gold standard for causal inference when everything runs perfectly, <strong>noncompliance</strong> can be an issue. Noncompliance occurs when an individual does not comply with the treatment that was randomly assigned.</p>
<p>Explain how instrumental variables estimation could be useful in a setting with noncompliance, and state clearly what causal effect is being estimated with the IV approach.</p>
<p><br><br></p>
</div>
<div id="exercise-4-4" class="section level3 unnumbered hasAnchor">
<h3>Exercise 4<a href="instrumental-variables-analysis.html#exercise-4-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>strength</strong> of an instrument refers to its degree of association with the treatment of interest. Strong instruments are highly associated with the treatment, and weak instruments have small associations with the treatment.</p>
<p>A characteristic of instrumental variables estimation is that the causal effect estimate has much higher variance for weak instruments than for strong instruments. By looking at the ratio form of the IV estimator, argue why this would be the case. (This can also be argued via thinking about the two-stage least squares approach if you wish.)</p>
<p><br><br></p>
</div>
<div id="extra-3" class="section level3 unnumbered hasAnchor">
<h3>Extra!<a href="instrumental-variables-analysis.html#extra-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you have time, work on this exercise.</p>
<p><strong>Before looking at the code below,</strong> plan an answer to the following research question with high-level pseudocode (a high-level description of code that you would write).</p>
<blockquote>
<p><strong>Research question:</strong> How could we write a simulation study to understand the impact of modeling choices on estimated results in IV settings where there are nonlinear relationships between variables in our causal system?</p>
</blockquote>
<p><br><br><br><br></p>
<p>Now examine the code below which implements an analysis to investigate the above question. Write a paragraph describing what this simulation study is doing and (preliminary) results from the study.</p>
<p>Code notes:</p>
<ul>
<li><p>The <code>ivpack</code> package is used to fit the two-stage least squares model. Specifically, you’ll want to look up the documentation for the <code>ivreg()</code> function.</p></li>
<li><p><code>replicate(n, {code})</code> repeats <code>{code}</code> <code>n</code> times.</p></li>
<li><p><code>I(x^2)</code> in a model formula instructs R to add a squared version of <code>x</code> to the dataset as another predictor.</p></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="instrumental-variables-analysis.html#cb29-1" aria-hidden="true"></a><span class="kw">library</span>(ivpack)</span>
<span id="cb29-2"><a href="instrumental-variables-analysis.html#cb29-2" aria-hidden="true"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb29-3"><a href="instrumental-variables-analysis.html#cb29-3" aria-hidden="true"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb29-4"><a href="instrumental-variables-analysis.html#cb29-4" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb29-5"><a href="instrumental-variables-analysis.html#cb29-5" aria-hidden="true"></a></span>
<span id="cb29-6"><a href="instrumental-variables-analysis.html#cb29-6" aria-hidden="true"></a>sim_binary &lt;-<span class="st"> </span><span class="cf">function</span>(n, log_odds) {</span>
<span id="cb29-7"><a href="instrumental-variables-analysis.html#cb29-7" aria-hidden="true"></a>    odds &lt;-<span class="st"> </span><span class="kw">exp</span>(log_odds)</span>
<span id="cb29-8"><a href="instrumental-variables-analysis.html#cb29-8" aria-hidden="true"></a>    p &lt;-<span class="st"> </span>odds<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>odds)</span>
<span id="cb29-9"><a href="instrumental-variables-analysis.html#cb29-9" aria-hidden="true"></a>    <span class="kw">rbinom</span>(n, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> p)</span>
<span id="cb29-10"><a href="instrumental-variables-analysis.html#cb29-10" aria-hidden="true"></a>}</span>
<span id="cb29-11"><a href="instrumental-variables-analysis.html#cb29-11" aria-hidden="true"></a></span>
<span id="cb29-12"><a href="instrumental-variables-analysis.html#cb29-12" aria-hidden="true"></a>simulate_and_estimate &lt;-<span class="st"> </span><span class="cf">function</span>(n, iv_strength) {</span>
<span id="cb29-13"><a href="instrumental-variables-analysis.html#cb29-13" aria-hidden="true"></a>    results &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>, {</span>
<span id="cb29-14"><a href="instrumental-variables-analysis.html#cb29-14" aria-hidden="true"></a>        Z &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb29-15"><a href="instrumental-variables-analysis.html#cb29-15" aria-hidden="true"></a></span>
<span id="cb29-16"><a href="instrumental-variables-analysis.html#cb29-16" aria-hidden="true"></a>        log_odds_IV &lt;-<span class="st"> </span><span class="dv">-3</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>Z <span class="op">+</span><span class="st"> </span><span class="fl">0.005</span><span class="op">*</span>(Z<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb29-17"><a href="instrumental-variables-analysis.html#cb29-17" aria-hidden="true"></a>        IV &lt;-<span class="st"> </span><span class="kw">sim_binary</span>(n, log_odds_IV)</span>
<span id="cb29-18"><a href="instrumental-variables-analysis.html#cb29-18" aria-hidden="true"></a></span>
<span id="cb29-19"><a href="instrumental-variables-analysis.html#cb29-19" aria-hidden="true"></a>        log_odds_A &lt;-<span class="st"> </span><span class="dv">-1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.04</span><span class="op">*</span>Z <span class="op">+</span><span class="st"> </span><span class="fl">0.004</span><span class="op">*</span>(Z<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>iv_strength<span class="op">*</span>IV</span>
<span id="cb29-20"><a href="instrumental-variables-analysis.html#cb29-20" aria-hidden="true"></a>        A &lt;-<span class="st"> </span><span class="kw">sim_binary</span>(n, log_odds_A)</span>
<span id="cb29-21"><a href="instrumental-variables-analysis.html#cb29-21" aria-hidden="true"></a></span>
<span id="cb29-22"><a href="instrumental-variables-analysis.html#cb29-22" aria-hidden="true"></a>        M &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>IV, <span class="dv">2</span>)</span>
<span id="cb29-23"><a href="instrumental-variables-analysis.html#cb29-23" aria-hidden="true"></a>        Y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">4</span> <span class="op">+</span><span class="st"> </span>Z <span class="op">+</span><span class="st"> </span><span class="dv">5</span><span class="op">*</span>A <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>(M<span class="op">^</span><span class="dv">2</span>), <span class="dv">2</span>)</span>
<span id="cb29-24"><a href="instrumental-variables-analysis.html#cb29-24" aria-hidden="true"></a></span>
<span id="cb29-25"><a href="instrumental-variables-analysis.html#cb29-25" aria-hidden="true"></a>        sim_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Z, IV, A, M, Y)</span>
<span id="cb29-26"><a href="instrumental-variables-analysis.html#cb29-26" aria-hidden="true"></a></span>
<span id="cb29-27"><a href="instrumental-variables-analysis.html#cb29-27" aria-hidden="true"></a>        iv_mod &lt;-<span class="st"> </span><span class="kw">ivreg</span>(Y <span class="op">~</span><span class="st"> </span>A <span class="op">+</span><span class="st"> </span>Z <span class="op">+</span><span class="st"> </span>M<span class="op">|</span>IV <span class="op">+</span><span class="st"> </span>Z <span class="op">+</span><span class="st"> </span>M, <span class="dt">data =</span> sim_data)</span>
<span id="cb29-28"><a href="instrumental-variables-analysis.html#cb29-28" aria-hidden="true"></a>        iv_mod2 &lt;-<span class="st"> </span><span class="kw">ivreg</span>(Y <span class="op">~</span><span class="st"> </span>A <span class="op">+</span><span class="st"> </span>Z <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(Z<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>M <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(M<span class="op">^</span><span class="dv">2</span>)<span class="op">|</span>IV <span class="op">+</span><span class="st"> </span>Z <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(Z<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>M <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(M<span class="op">^</span><span class="dv">2</span>), <span class="dt">data =</span> sim_data)</span>
<span id="cb29-29"><a href="instrumental-variables-analysis.html#cb29-29" aria-hidden="true"></a>        <span class="kw">c</span>(<span class="dt">iv_strength =</span> iv_strength, <span class="dt">estim1 =</span> <span class="kw">unname</span>(<span class="kw">coefficients</span>(iv_mod)[<span class="st">&quot;A&quot;</span>]), <span class="dt">estim2 =</span> <span class="kw">unname</span>(<span class="kw">coefficients</span>(iv_mod2)[<span class="st">&quot;A&quot;</span>]))</span>
<span id="cb29-30"><a href="instrumental-variables-analysis.html#cb29-30" aria-hidden="true"></a>    })</span>
<span id="cb29-31"><a href="instrumental-variables-analysis.html#cb29-31" aria-hidden="true"></a>    results <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">t</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>()</span>
<span id="cb29-32"><a href="instrumental-variables-analysis.html#cb29-32" aria-hidden="true"></a>}</span>
<span id="cb29-33"><a href="instrumental-variables-analysis.html#cb29-33" aria-hidden="true"></a></span>
<span id="cb29-34"><a href="instrumental-variables-analysis.html#cb29-34" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">451</span>)</span>
<span id="cb29-35"><a href="instrumental-variables-analysis.html#cb29-35" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb29-36"><a href="instrumental-variables-analysis.html#cb29-36" aria-hidden="true"></a>result1 &lt;-<span class="st"> </span><span class="kw">simulate_and_estimate</span>(n, <span class="dt">iv_strength =</span> <span class="fl">0.1</span>)</span>
<span id="cb29-37"><a href="instrumental-variables-analysis.html#cb29-37" aria-hidden="true"></a>result2 &lt;-<span class="st"> </span><span class="kw">simulate_and_estimate</span>(n, <span class="dt">iv_strength =</span> <span class="fl">0.4</span>)</span>
<span id="cb29-38"><a href="instrumental-variables-analysis.html#cb29-38" aria-hidden="true"></a>result3 &lt;-<span class="st"> </span><span class="kw">simulate_and_estimate</span>(n, <span class="dt">iv_strength =</span> <span class="fl">0.8</span>)</span>
<span id="cb29-39"><a href="instrumental-variables-analysis.html#cb29-39" aria-hidden="true"></a></span>
<span id="cb29-40"><a href="instrumental-variables-analysis.html#cb29-40" aria-hidden="true"></a>all_results &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(result1, result2, result3)</span>
<span id="cb29-41"><a href="instrumental-variables-analysis.html#cb29-41" aria-hidden="true"></a>all_results &lt;-<span class="st"> </span>all_results <span class="op">%&gt;%</span></span>
<span id="cb29-42"><a href="instrumental-variables-analysis.html#cb29-42" aria-hidden="true"></a><span class="st">    </span><span class="kw">pivot_longer</span>(<span class="op">-</span>iv_strength, <span class="dt">names_to =</span> <span class="st">&quot;model_type&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;estimate&quot;</span>)</span>
<span id="cb29-43"><a href="instrumental-variables-analysis.html#cb29-43" aria-hidden="true"></a></span>
<span id="cb29-44"><a href="instrumental-variables-analysis.html#cb29-44" aria-hidden="true"></a><span class="kw">ggplot</span>(all_results, <span class="kw">aes</span>(<span class="dt">x =</span> model_type, <span class="dt">y =</span> estimate)) <span class="op">+</span></span>
<span id="cb29-45"><a href="instrumental-variables-analysis.html#cb29-45" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb29-46"><a href="instrumental-variables-analysis.html#cb29-46" aria-hidden="true"></a><span class="st">    </span><span class="kw">facet_grid</span>(<span class="op">~</span>iv_strength) <span class="op">+</span></span>
<span id="cb29-47"><a href="instrumental-variables-analysis.html#cb29-47" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">5</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb29-48"><a href="instrumental-variables-analysis.html#cb29-48" aria-hidden="true"></a><span class="kw">ggplot</span>(all_results, <span class="kw">aes</span>(<span class="dt">x =</span> model_type, <span class="dt">y =</span> estimate)) <span class="op">+</span></span>
<span id="cb29-49"><a href="instrumental-variables-analysis.html#cb29-49" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb29-50"><a href="instrumental-variables-analysis.html#cb29-50" aria-hidden="true"></a><span class="st">    </span><span class="kw">facet_grid</span>(<span class="op">~</span>iv_strength) <span class="op">+</span></span>
<span id="cb29-51"><a href="instrumental-variables-analysis.html#cb29-51" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">5</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb29-52"><a href="instrumental-variables-analysis.html#cb29-52" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">200</span>,<span class="dv">200</span>))</span></code></pre></div>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="interrupted-time-series.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="homework-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
