<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Homework 5 | STAT 451: Causal Inference</title>
  <meta name="description" content="This is the class website for Causal Inference (STAT 451) at Macalester College." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Homework 5 | STAT 451: Causal Inference" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the class website for Causal Inference (STAT 451) at Macalester College." />
  <meta name="github-repo" content="lmyint/causal_spring_2023" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Homework 5 | STAT 451: Causal Inference" />
  
  <meta name="twitter:description" content="This is the class website for Causal Inference (STAT 451) at Macalester College." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="homework-4.html"/>
<link rel="next" href="final-reflection.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="custom_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">STAT 451: Causal Inference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a>
<ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#required-references"><i class="fa fa-check"></i>Required references</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references-for-review"><i class="fa fa-check"></i>References for review</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#further-exploration"><i class="fa fa-check"></i>Further exploration</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="guiding-questions.html"><a href="guiding-questions.html"><i class="fa fa-check"></i>Guiding Questions</a></li>
<li class="part"><span><b>I Foundational Ideas</b></span></li>
<li class="chapter" data-level="1" data-path="motivation-and-review.html"><a href="motivation-and-review.html"><i class="fa fa-check"></i><b>1</b> Motivation and Review</a>
<ul>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#discussion-prompts"><i class="fa fa-check"></i>Discussion prompts</a>
<ul>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#considering-causes"><i class="fa fa-check"></i>Considering causes</a></li>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#sinful-saying-or-mandatory-mantra"><i class="fa fa-check"></i>Sinful saying or mandatory mantra?</a></li>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#sufficiency-and-necessity"><i class="fa fa-check"></i>Sufficiency and necessity</a></li>
<li class="chapter" data-level="" data-path="motivation-and-review.html"><a href="motivation-and-review.html#evaluating-evidence-for-causation-bradford-hill-criteria"><i class="fa fa-check"></i>Evaluating evidence for causation: Bradford Hill criteria</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exchangeability.html"><a href="exchangeability.html"><i class="fa fa-check"></i><b>2</b> Exchangeability</a>
<ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#learning-goals"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercises"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-5"><i class="fa fa-check"></i>Exercise 5</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-6-extra"><i class="fa fa-check"></i>Exercise 6 (Extra)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-7-extra"><i class="fa fa-check"></i>Exercise 7 (Extra)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="study-designs.html"><a href="study-designs.html"><i class="fa fa-check"></i><b>3</b> Study Designs</a>
<ul>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#learning-goals-1"><i class="fa fa-check"></i>Learning goals</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#exercises-1"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#peer-check-in"><i class="fa fa-check"></i>Peer check-in</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#exercise-2-1"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#exercise-3-1"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="study-designs.html"><a href="study-designs.html#extra"><i class="fa fa-check"></i>Extra</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Causal Graphs</b></span></li>
<li class="chapter" data-level="4" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html"><i class="fa fa-check"></i><b>4</b> Causal Graphs as Statistical Models</a>
<ul>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#learning-goals-2"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#simulating-data-in-r"><i class="fa fa-check"></i>Simulating data in R</a>
<ul>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#why-simulate"><i class="fa fa-check"></i>Why simulate?</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#simulation-functions-in-r"><i class="fa fa-check"></i>Simulation functions in R</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#simulating-data-from-graphssems"><i class="fa fa-check"></i>Simulating data from graphs+SEMs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#exercises-2"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#exercise-1-2"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#extra-1"><i class="fa fa-check"></i>Extra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html"><i class="fa fa-check"></i><b>5</b> Key Structures in Causal Graphs</a>
<ul>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#learning-goals-3"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercises-3"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercise-1-3"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercise-2-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercise-3-2"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#exercise-4-1"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="key-structures-in-causal-graphs.html"><a href="key-structures-in-causal-graphs.html#extra-2"><i class="fa fa-check"></i>Extra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html"><i class="fa fa-check"></i><b>6</b> Graphical Structure of Confounding</a>
<ul>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#learning-goals-4"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#exercises-4"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#exercise-1-4"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#exercise-2-3"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-confounding.html"><a href="graphical-structure-of-confounding.html#exercise-3-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphical-structure-of-selection-bias.html"><a href="graphical-structure-of-selection-bias.html"><i class="fa fa-check"></i><b>7</b> Graphical Structure of Selection Bias</a>
<ul>
<li class="chapter" data-level="" data-path="graphical-structure-of-selection-bias.html"><a href="graphical-structure-of-selection-bias.html#learning-goals-5"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-selection-bias.html"><a href="graphical-structure-of-selection-bias.html#exercises-5"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="graphical-structure-of-selection-bias.html"><a href="graphical-structure-of-selection-bias.html#exercise-1-5"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-selection-bias.html"><a href="graphical-structure-of-selection-bias.html#exercise-2-4"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-selection-bias.html"><a href="graphical-structure-of-selection-bias.html#exercise-3-4"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="the-smoking-birth-weight-paradox.html"><a href="the-smoking-birth-weight-paradox.html"><i class="fa fa-check"></i><b>8</b> The Smoking-Birth Weight Paradox</a>
<ul>
<li class="chapter" data-level="" data-path="the-smoking-birth-weight-paradox.html"><a href="the-smoking-birth-weight-paradox.html#our-task"><i class="fa fa-check"></i>Our Task</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="building-causal-graphs-for-applied-analyses.html"><a href="building-causal-graphs-for-applied-analyses.html"><i class="fa fa-check"></i><b>9</b> Building Causal Graphs for Applied Analyses</a>
<ul>
<li class="chapter" data-level="" data-path="building-causal-graphs-for-applied-analyses.html"><a href="building-causal-graphs-for-applied-analyses.html#learning-goals-6"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="building-causal-graphs-for-applied-analyses.html"><a href="building-causal-graphs-for-applied-analyses.html#exercises-6"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="building-causal-graphs-for-applied-analyses.html"><a href="building-causal-graphs-for-applied-analyses.html#data-context"><i class="fa fa-check"></i>Data context</a></li>
<li class="chapter" data-level="" data-path="building-causal-graphs-for-applied-analyses.html"><a href="building-causal-graphs-for-applied-analyses.html#collaborative-causal-graph-construction"><i class="fa fa-check"></i>Collaborative causal graph construction</a></li>
<li class="chapter" data-level="" data-path="building-causal-graphs-for-applied-analyses.html"><a href="building-causal-graphs-for-applied-analyses.html#incorporate-information-on-available-variables"><i class="fa fa-check"></i>Incorporate information on available variables</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Estimation</b></span></li>
<li class="chapter" data-level="10" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html"><i class="fa fa-check"></i><b>10</b> Applied Analysis: Regression</a>
<ul>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#learning-goals-7"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#analysis"><i class="fa fa-check"></i>Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#data-context-and-research-questions"><i class="fa fa-check"></i>Data context and research questions</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#part-1-finalize-adjustment-set"><i class="fa fa-check"></i>Part 1: Finalize adjustment set</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#part-2-exploratory-analysis"><i class="fa fa-check"></i>Part 2: Exploratory analysis</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#part-3-modeling"><i class="fa fa-check"></i>Part 3: Modeling</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#part-4-interpretation-and-discussion"><i class="fa fa-check"></i>Part 4: Interpretation and discussion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="applied-analysis-regression.html"><a href="applied-analysis-regression.html#simulation-study-planning"><i class="fa fa-check"></i>Simulation study planning</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html"><i class="fa fa-check"></i><b>11</b> Inverse Probability Weighting</a>
<ul>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#learning-goals-8"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#exercises-7"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#exercise-1-6"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#exercise-2-5"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#exercise-3-5"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#exercise-4-2"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inverse-probability-weighting.html"><a href="inverse-probability-weighting.html#debrief"><i class="fa fa-check"></i>Debrief</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ipw-simulation.html"><a href="ipw-simulation.html"><i class="fa fa-check"></i><b>12</b> IPW: Simulation</a>
<ul>
<li class="chapter" data-level="" data-path="ipw-simulation.html"><a href="ipw-simulation.html#learning-goals-9"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="ipw-simulation.html"><a href="ipw-simulation.html#exercises-8"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="ipw-simulation.html"><a href="ipw-simulation.html#exercise-1-simulate"><i class="fa fa-check"></i>Exercise 1: Simulate</a></li>
<li class="chapter" data-level="" data-path="ipw-simulation.html"><a href="ipw-simulation.html#exercise-2-inverse-probability-weighting"><i class="fa fa-check"></i>Exercise 2: Inverse probability weighting</a></li>
<li class="chapter" data-level="" data-path="ipw-simulation.html"><a href="ipw-simulation.html#exercise-3-balance-checking"><i class="fa fa-check"></i>Exercise 3: Balance checking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html"><i class="fa fa-check"></i><b>13</b> Applied Analysis: IPW</a>
<ul>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#learning-goals-10"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#analysis-1"><i class="fa fa-check"></i>Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#data-context-and-research-questions-1"><i class="fa fa-check"></i>Data context and research questions</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#loading-data-and-packages"><i class="fa fa-check"></i>Loading data and packages</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#part-1-review-outcome-regression-results"><i class="fa fa-check"></i>Part 1: Review outcome regression results</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#part-2-propensity-score-modeling"><i class="fa fa-check"></i>Part 2: Propensity score modeling</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#part-3-modeling-with-ip-weights"><i class="fa fa-check"></i>Part 3: Modeling with IP weights</a></li>
<li class="chapter" data-level="" data-path="applied-analysis-ipw.html"><a href="applied-analysis-ipw.html#part-4-causal-graphs-and-missing-data"><i class="fa fa-check"></i>Part 4: Causal graphs and missing data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV New Research Questions</b></span></li>
<li class="chapter" data-level="14" data-path="time-varying-treatments-and-mediation-analysis.html"><a href="time-varying-treatments-and-mediation-analysis.html"><i class="fa fa-check"></i><b>14</b> Time-Varying Treatments and Mediation Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="time-varying-treatments-and-mediation-analysis.html"><a href="time-varying-treatments-and-mediation-analysis.html#learning-goals-11"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="time-varying-treatments-and-mediation-analysis.html"><a href="time-varying-treatments-and-mediation-analysis.html#exercises-9"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="time-varying-treatments-and-mediation-analysis.html"><a href="time-varying-treatments-and-mediation-analysis.html#exercise-1-7"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="time-varying-treatments-and-mediation-analysis.html"><a href="time-varying-treatments-and-mediation-analysis.html#exercise-2-6"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="time-varying-treatments-and-mediation-analysis.html"><a href="time-varying-treatments-and-mediation-analysis.html#exercise-3-6"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Sensitivity Analyses</b></span></li>
<li class="chapter" data-level="15" data-path="sensitivity-analyses-for-unmeasured-variables.html"><a href="sensitivity-analyses-for-unmeasured-variables.html"><i class="fa fa-check"></i><b>15</b> Sensitivity Analyses for Unmeasured Variables</a>
<ul>
<li class="chapter" data-level="" data-path="sensitivity-analyses-for-unmeasured-variables.html"><a href="sensitivity-analyses-for-unmeasured-variables.html#learning-goals-12"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="sensitivity-analyses-for-unmeasured-variables.html"><a href="sensitivity-analyses-for-unmeasured-variables.html#example-with-the-tipr-package"><i class="fa fa-check"></i>Example with the <code>tipr</code> package</a></li>
<li class="chapter" data-level="" data-path="sensitivity-analyses-for-unmeasured-variables.html"><a href="sensitivity-analyses-for-unmeasured-variables.html#discussion-questions"><i class="fa fa-check"></i>Discussion questions</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="causal-discovery.html"><a href="causal-discovery.html"><i class="fa fa-check"></i><b>16</b> Causal Discovery</a>
<ul>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#learning-goals-13"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercises-10"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-1-8"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-2-7"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-3-7"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-4-3"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Quasi-Experimental Designs</b></span></li>
<li class="chapter" data-level="17" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html"><i class="fa fa-check"></i><b>17</b> Regression Discontinuity</a>
<ul>
<li class="chapter" data-level="" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#learning-goals-14"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#exercises-11"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#context-and-setup"><i class="fa fa-check"></i>Context and setup</a></li>
<li class="chapter" data-level="" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#main-analysis"><i class="fa fa-check"></i>Main analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="interrupted-time-series.html"><a href="interrupted-time-series.html"><i class="fa fa-check"></i><b>18</b> Interrupted Time Series</a>
<ul>
<li class="chapter" data-level="" data-path="interrupted-time-series.html"><a href="interrupted-time-series.html#learning-goals-15"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="interrupted-time-series.html"><a href="interrupted-time-series.html#discussion"><i class="fa fa-check"></i>Discussion</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html"><i class="fa fa-check"></i><b>19</b> Instrumental Variables Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#learning-goals-16"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#exercises-12"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#exercise-1-9"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#exercise-2-8"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#exercise-3-8"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#exercise-4-4"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="instrumental-variables-analysis.html"><a href="instrumental-variables-analysis.html#extra-3"><i class="fa fa-check"></i>Extra!</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII Homework</b></span></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html"><i class="fa fa-check"></i>Homework 1</a>
<ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#general-instructions"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-1"><i class="fa fa-check"></i>Part 1</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-2"><i class="fa fa-check"></i>Part 2</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-3"><i class="fa fa-check"></i>Part 3</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-4"><i class="fa fa-check"></i>Part 4</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#part-5"><i class="fa fa-check"></i>Part 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i>Homework 2</a>
<ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#general-instructions-1"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#revisions"><i class="fa fa-check"></i>Revisions</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#part-1-1"><i class="fa fa-check"></i>Part 1</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#part-2-1"><i class="fa fa-check"></i>Part 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html"><i class="fa fa-check"></i>Homework 3</a>
<ul>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#general-instructions-2"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#revisions-1"><i class="fa fa-check"></i>Revisions</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#clarifying-the-big-picture"><i class="fa fa-check"></i>Clarifying the big picture</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#the-smoking-birthweight-paradox"><i class="fa fa-check"></i>The smoking-birthweight paradox</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#exchangeability-computation"><i class="fa fa-check"></i>Exchangeability: Computation</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#exchangeability-explaining-via-causal-graphs"><i class="fa fa-check"></i>Exchangeability: explaining via causal graphs</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#simulation-d-separation-and-exchangeability"><i class="fa fa-check"></i>Simulation, d-separation, and exchangeability</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#study-designs-examples-of-applied-studies"><i class="fa fa-check"></i>Study designs: examples of applied studies</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#metacognitive-reflection"><i class="fa fa-check"></i>Metacognitive Reflection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html"><i class="fa fa-check"></i>Homework 4</a>
<ul>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#general-instructions-3"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#revisions-2"><i class="fa fa-check"></i>Revisions</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#drawing-causal-graphs"><i class="fa fa-check"></i>Drawing causal graphs</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#general-workflow-for-regression-and-ipw"><i class="fa fa-check"></i>General workflow for regression and IPW</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#metacognitive-reflection-1"><i class="fa fa-check"></i>Metacognitive Reflection</a></li>
<li class="chapter" data-level="" data-path="homework-4.html"><a href="homework-4.html#final-project-proposal"><i class="fa fa-check"></i>Final Project Proposal</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html"><i class="fa fa-check"></i>Homework 5</a>
<ul>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#general-instructions-4"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#revisions-3"><i class="fa fa-check"></i>Revisions</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#project-work-reqd"><i class="fa fa-check"></i>Project Work (REQD)</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#metacognitive-reflection-reqd"><i class="fa fa-check"></i>Metacognitive Reflection (REQD)</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#sensitivity-analysis-for-unmeasured-confounding-reqd"><i class="fa fa-check"></i>Sensitivity analysis for unmeasured confounding (REQD)</a>
<ul>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#context"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#implementation-with-tipr"><i class="fa fa-check"></i>Implementation with <code>tipr</code></a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#interpret"><i class="fa fa-check"></i>Interpret</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#causal-discovery-reqd"><i class="fa fa-check"></i>Causal discovery (REQD)</a>
<ul>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#exercise-1-10"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#exercise-2-9"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#exercise-3-9"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#simulation-study-for-sensitivity-analyses"><i class="fa fa-check"></i>Simulation study for sensitivity analyses</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#learning-about-mediation-analysis"><i class="fa fa-check"></i>Learning about mediation analysis</a></li>
<li class="chapter" data-level="" data-path="homework-5.html"><a href="homework-5.html#randomized-experiments"><i class="fa fa-check"></i>Randomized experiments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="final-reflection.html"><a href="final-reflection.html"><i class="fa fa-check"></i>Final Reflection</a>
<ul>
<li class="chapter" data-level="" data-path="final-reflection.html"><a href="final-reflection.html#general-instructions-5"><i class="fa fa-check"></i>General instructions</a></li>
<li class="chapter" data-level="" data-path="final-reflection.html"><a href="final-reflection.html#reflection"><i class="fa fa-check"></i>Reflection</a>
<ul>
<li class="chapter" data-level="" data-path="final-reflection.html"><a href="final-reflection.html#part-1-looking-back"><i class="fa fa-check"></i>Part 1: Looking back</a></li>
<li class="chapter" data-level="" data-path="final-reflection.html"><a href="final-reflection.html#part-2-now"><i class="fa fa-check"></i>Part 2: Now</a></li>
<li class="chapter" data-level="" data-path="final-reflection.html"><a href="final-reflection.html#part-3-final-grade"><i class="fa fa-check"></i>Part 3: Final Grade</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VIII Project</b></span></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html"><i class="fa fa-check"></i>Final Project</a>
<ul>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#project-options"><i class="fa fa-check"></i>Project Options</a>
<ul>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#option-1-data-analysis"><i class="fa fa-check"></i>Option 1: Data analysis</a></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#option-2-blog-posts"><i class="fa fa-check"></i>Option 2: Blog posts</a></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#option-3-learn-an-advanced-topic"><i class="fa fa-check"></i>Option 3: Learn an advanced topic</a></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#option-4-other"><i class="fa fa-check"></i>Option 4: Other</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#deliverables"><i class="fa fa-check"></i>Deliverables</a></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#timeline"><i class="fa fa-check"></i>Timeline</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 451: Causal Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="homework-5" class="section level1 unnumbered hasAnchor">
<h1>Homework 5<a href="homework-5.html#homework-5" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="general-instructions-4" class="section level2 unnumbered hasAnchor">
<h2>General instructions<a href="homework-5.html#general-instructions-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Due <strong>Friday, March 31</strong> at midnight CST.</li>
<li>Please complete the exercises marked (REQD). (Project Work, Metacognitive Reflection, Sensitivity Analysis, and Causal Discovery)</li>
<li>The other exercises provide opportunities to explore ideas more deeply and re-engage with past ideas. Complete whatever aligns with your goals.</li>
</ul>
<p><br><br></p>
</div>
<div id="revisions-3" class="section level2 unnumbered hasAnchor">
<h2>Revisions<a href="homework-5.html#revisions-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you would like to make revisions to any parts of prior assignments, please do the following:</p>
<ul>
<li>Keep all old writing and feedback intact</li>
<li>Un-highlight yellow text that has already been addressed with feedback and revisions</li>
<li>Write an updated response just below your previous response and highlight the new writing in yellow</li>
</ul>
<p><br><br></p>
</div>
<div id="project-work-reqd" class="section level2 unnumbered hasAnchor">
<h2>Project Work (REQD)<a href="homework-5.html#project-work-reqd" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Take a look at our <a href="final-project.html">Final Project page</a> and make as much progress as you can towards Milestone 2. <strong>Create a separate Google Doc for your project work</strong>, and share this document with the instructor. (Just create one Google Doc per team if you’re working with teammates.)</p>
<p>This project-specific Google Doc is where intermediate work and feedback will be recorded even if the ultimate deliverable ends up being something other than a written report (e.g., presentation, website).</p>
<p><br><br></p>
</div>
<div id="metacognitive-reflection-reqd" class="section level2 unnumbered hasAnchor">
<h2>Metacognitive Reflection (REQD)<a href="homework-5.html#metacognitive-reflection-reqd" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this reflection, check in on your understanding of our new topics in light of the breakdown below (which you can disagree with!). (Do this reflection after the main exercises.)</p>
<ul>
<li>Enduring concepts:
<ul>
<li>Why do we do sensitivity analyses for unmeasured variables and how, in general, do we interpret results?</li>
<li>What is the goal of causal discovery?</li>
</ul></li>
<li>Important concepts:
<ul>
<li>Making connections between the probability underlying casual graphs and why we need to specify parameters in sensitivity analyses</li>
<li>Details of the causal discovery algorithm covered in the concept video</li>
</ul></li>
<li>Concepts worth being familiar with:
<ul>
<li>What do you think should go under this category?</li>
</ul></li>
</ul>
<p><br><br></p>
</div>
<div id="sensitivity-analysis-for-unmeasured-confounding-reqd" class="section level2 unnumbered hasAnchor">
<h2>Sensitivity analysis for unmeasured confounding (REQD)<a href="homework-5.html#sensitivity-analysis-for-unmeasured-confounding-reqd" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="context" class="section level3 unnumbered hasAnchor">
<h3>Context<a href="homework-5.html#context" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Does smoking actually cause lung cancer? There was great debate in the 1950s and 1960s on this issue. A prominent statistician R. A. Fisher (a longtime smoker) was dubious of the actual causal relationship and proposed that some genetic variant might be more common in smokers and also increase lung cancer risk.</p>
<p>In the paper <a href="https://academic.oup.com/ije/article-pdf/38/5/1175/18480532/dyp289.pdf">Smoking and lung cancer: recent evidence and a discussion of some questions</a>, Jerome Cornfield and co-authors report on a sensitivity analysis for unmeasured confounding to address Fisher’s proposition (second column on page 1186). We’ll corroborate these results in this exercise.</p>
</div>
<div id="implementation-with-tipr" class="section level3 unnumbered hasAnchor">
<h3>Implementation with <code>tipr</code><a href="homework-5.html#implementation-with-tipr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <code>adjust_rr_with_binary()</code> function in the <code>tipr</code> package to implement a sensitivity analysis. <code>rr</code> stands for relative risk and is a probability ratio (as opposed to an odds ratio). Relative risks are alternate effect measures for binary outcomes.</p>
<ul>
<li>First look at the <a href="https://lucymcgowan.github.io/tipr/reference/adjust_rr_with_binary.html">documentation</a> for this function.
<ul>
<li>Note that because our causal effect is a relative risk, the <code>confounder_outcome_effect</code> is also quantified with a relative risk.</li>
</ul></li>
<li>Use the <code>seq()</code> function to generate a sequence of regularly spaced values for the <code>exposed_confounder_prev</code>, <code>unexposed_confounder_prev</code>, and <code>confounder_outcome_effect</code> arguments.
<ul>
<li>Look at the documentation for the <code>seq()</code> function to understand how the arguments work.</li>
<li>Use the background information in the data context above to guide parameter choices and the <code>filter()</code> step below.</li>
</ul></li>
<li><a href="https://bmjopen.bmj.com/content/8/10/e021611">A recent study</a> suggests that the causal effect (before considering any unmeasured confounders) is a relative risk of about 7.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="homework-5.html#cb30-1" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb30-2"><a href="homework-5.html#cb30-2" aria-hidden="true"></a><span class="kw">library</span>(tipr)</span>
<span id="cb30-3"><a href="homework-5.html#cb30-3" aria-hidden="true"></a></span>
<span id="cb30-4"><a href="homework-5.html#cb30-4" aria-hidden="true"></a><span class="co"># This creates all combinations of values across the 3 parameters</span></span>
<span id="cb30-5"><a href="homework-5.html#cb30-5" aria-hidden="true"></a>parameter_combos &lt;-<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">crossing</span>(</span>
<span id="cb30-6"><a href="homework-5.html#cb30-6" aria-hidden="true"></a>    <span class="dt">exposed_confounder_prev =</span> <span class="kw">seq</span>(<span class="dt">from =</span> ___, <span class="dt">to =</span> ___, <span class="dt">by =</span> ___),</span>
<span id="cb30-7"><a href="homework-5.html#cb30-7" aria-hidden="true"></a>    <span class="dt">unexposed_confounder_prev =</span> <span class="kw">seq</span>(<span class="dt">from =</span> ___, <span class="dt">to =</span> ___, <span class="dt">by =</span> ___),</span>
<span id="cb30-8"><a href="homework-5.html#cb30-8" aria-hidden="true"></a>    <span class="dt">confounder_outcome_effect =</span> <span class="kw">seq</span>(<span class="dt">from =</span> ___, <span class="dt">to =</span> ___, <span class="dt">by =</span> ___)</span>
<span id="cb30-9"><a href="homework-5.html#cb30-9" aria-hidden="true"></a>)</span>
<span id="cb30-10"><a href="homework-5.html#cb30-10" aria-hidden="true"></a></span>
<span id="cb30-11"><a href="homework-5.html#cb30-11" aria-hidden="true"></a><span class="co"># Use dplyr::filter() to remove combinations that won&#39;t &quot;explain away&quot; (make null) the observed causal effect</span></span>
<span id="cb30-12"><a href="homework-5.html#cb30-12" aria-hidden="true"></a><span class="co"># i.e., make sure that the parameters indicate the correct sign of the U-&gt;A relationship</span></span>
<span id="cb30-13"><a href="homework-5.html#cb30-13" aria-hidden="true"></a>parameter_combos &lt;-<span class="st"> </span>parameter_combos <span class="op">%&gt;%</span></span>
<span id="cb30-14"><a href="homework-5.html#cb30-14" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>()</span>
<span id="cb30-15"><a href="homework-5.html#cb30-15" aria-hidden="true"></a></span>
<span id="cb30-16"><a href="homework-5.html#cb30-16" aria-hidden="true"></a><span class="co"># Run sensitivity analysis</span></span>
<span id="cb30-17"><a href="homework-5.html#cb30-17" aria-hidden="true"></a>sens_results &lt;-<span class="st"> </span><span class="kw">adjust_rr_with_binary</span>(</span>
<span id="cb30-18"><a href="homework-5.html#cb30-18" aria-hidden="true"></a>    <span class="dt">effect_observed =</span> ___,</span>
<span id="cb30-19"><a href="homework-5.html#cb30-19" aria-hidden="true"></a>    <span class="dt">exposed_confounder_prev =</span> parameter_combos<span class="op">$</span>exposed_confounder_prev,</span>
<span id="cb30-20"><a href="homework-5.html#cb30-20" aria-hidden="true"></a>    <span class="dt">unexposed_confounder_prev =</span> parameter_combos<span class="op">$</span>unexposed_confounder_prev,</span>
<span id="cb30-21"><a href="homework-5.html#cb30-21" aria-hidden="true"></a>    <span class="dt">confounder_outcome_effect =</span> parameter_combos<span class="op">$</span>confounder_outcome_effect,</span>
<span id="cb30-22"><a href="homework-5.html#cb30-22" aria-hidden="true"></a>    <span class="dt">verbose =</span> <span class="ot">FALSE</span></span>
<span id="cb30-23"><a href="homework-5.html#cb30-23" aria-hidden="true"></a>)</span></code></pre></div>
</div>
<div id="visualize" class="section level3 unnumbered hasAnchor">
<h3>Visualize<a href="homework-5.html#visualize" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Visualize the sensitivity analysis results in a way that you find effective.</p>
<ul>
<li>The instructor found it helpful to collapse the <code>exposed_confounder_prev</code> and <code>unexposed_confounder_prev</code> parameters into a single parameter:</li>
<li>You may find it helpful to show all 3 parameters directly in your visualization.</li>
</ul>
</div>
<div id="interpret" class="section level3 unnumbered hasAnchor">
<h3>Interpret<a href="homework-5.html#interpret" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Explain the general trends you see in your visualization.</li>
<li>Use both your visualization and the <code>sens_results</code> data frame to identify what parameter combinations nullify the observed causal effect (at least approximately).</li>
<li>Based on these results, comment on the robustness of the original causal effect estimate. Describe what background research you might need to conduct to contextualize how realistic the nullifying parameters are.</li>
</ul>
<p><br><br></p>
</div>
</div>
<div id="causal-discovery-reqd" class="section level2 unnumbered hasAnchor">
<h2>Causal discovery (REQD)<a href="homework-5.html#causal-discovery-reqd" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercise-1-10" class="section level3 unnumbered hasAnchor">
<h3>Exercise 1<a href="homework-5.html#exercise-1-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider data that truly come from a fork <code>X &lt;- Y -&gt; Z</code>. What pattern would a causal discovery algorithm report?</p>
<p>If you could supply prior knowledge to the algorithm on only one edge that is required to be present, what edge (if any) would allow the entire structure to be learned? Explain briefly.</p>
</div>
<div id="exercise-2-9" class="section level3 unnumbered hasAnchor">
<h3>Exercise 2<a href="homework-5.html#exercise-2-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have learned the following structure from the skeleton building phase.</p>
<p><img src="causal_manual_files/figure-html/hw5_dag-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We have the following results from conditional independence tests (<span class="math inline">\(H_0\)</span> indicates conditional independence, significance level = 0.01):</p>
<ul>
<li><span class="math inline">\(X \perp\!\!\!\perp Z \mid Y\)</span>? p-value = 0.001</li>
<li><span class="math inline">\(X \perp\!\!\!\perp W \mid Y\)</span>? p-value = 0.1</li>
<li><span class="math inline">\(Y \perp\!\!\!\perp V \mid W\)</span>? p-value = 0.1</li>
<li><span class="math inline">\(U \perp\!\!\!\perp W \mid V\)</span>? p-value = 0.1</li>
</ul>
<p>What pattern would a causal discovery algorithm report? Show your work.</p>
</div>
<div id="exercise-3-9" class="section level3 unnumbered hasAnchor">
<h3>Exercise 3<a href="homework-5.html#exercise-3-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have measured 3 variables <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span>, and <span class="math inline">\(Z\)</span> (all quantitative). You can read in the data below.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="homework-5.html#cb31-1" aria-hidden="true"></a>disc_data &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&quot;https://www.dropbox.com/s/moj3k3fed7puicr/discovery_data.csv?dl=1&quot;</span>)</span></code></pre></div>
<ul>
<li>Step through the causal discovery process, using regression models as your conditional independence test. Use a type 1 error rate (significance level) of <span class="math inline">\(\alpha=0.01\)</span>. Show all work. This involves:
<ul>
<li>Showing model output.</li>
<li>Writing a sentence using numbers from the output at each step to show the decisions made by the algorithm.</li>
</ul></li>
<li>Report the final output that the discovery algorithm would give.</li>
</ul>
<p><br><br></p>
</div>
<div id="simulation-study-for-sensitivity-analyses" class="section level3 unnumbered hasAnchor">
<h3>Simulation study for sensitivity analyses<a href="homework-5.html#simulation-study-for-sensitivity-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Conduct a simulation where the true average causal effect is zero but where there is an unmeasured confounder with <code>U-&gt;A</code> and <code>U-&gt;Y</code> effect magnitudes that you set. Use the <code>tipr</code> package to investigate if sensitivity analysis results align with your simulation setup. (You’ll have to look through the package <a href="https://lucymcgowan.github.io/tipr/reference/index.html">documentation</a> to find the right sensitivity analysis function.)</p>
<p><br><br></p>
</div>
<div id="learning-about-mediation-analysis" class="section level3 unnumbered hasAnchor">
<h3>Learning about mediation analysis<a href="homework-5.html#learning-about-mediation-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mediation analysis was a topic that we were going to talk about on Monday, March 20. We may come back to it after we finish the other topics on our schedule, but if you’d like to learn a little more about this topic, check out the following resources:</p>
<ul>
<li><a href="https://youtu.be/wTZ-5zBmwRo">YouTube video</a> (with <a href="https://drive.google.com/file/d/1xp5usL2pDE8q649z3MoRj1qMh4s5fb8i/view?usp=sharing">slides</a>)</li>
<li>Overview paper: Nguyen, T. Q., Schmid, I., &amp; Stuart, E. A. (2020). Clarifying causal mediation analysis for the applied researcher: Defining effects based on what we want to learn. Psychological Methods. <a href="https://doi.org/10.1037/met0000299" class="uri">https://doi.org/10.1037/met0000299</a></li>
</ul>
<p><br><br></p>
</div>
<div id="randomized-experiments" class="section level3 unnumbered hasAnchor">
<h3>Randomized experiments<a href="homework-5.html#randomized-experiments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This exercise can help work through the idea that randomized experiments are the “gold standard” for causal inference.</p>
<ul>
<li>Simulate data from a fork structure where <code>U</code> is a common cause of <code>A</code> and <code>Y</code>.</li>
<li>In the part of your code when you simulate <code>Y</code>, also simulate the potential outcomes under treatment and control (<code>Ya1</code> and <code>Ya0</code>) by setting the <code>A</code> part equal to 1 for <code>Ya1</code> and 0 for <code>Ya0</code>.</li>
<li>Create a new version of treatment called <code>A_rand</code> which is a randomly assigned treatment (in contrast to naturally-occurring treatment <code>A</code> which is affected by <code>Z</code>) using the <code>sample()</code> function:</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="homework-5.html#cb32-1" aria-hidden="true"></a><span class="co"># This randomly assigns half of the units to treatment and half to control</span></span>
<span id="cb32-2"><a href="homework-5.html#cb32-2" aria-hidden="true"></a>A_rand &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">each =</span> n<span class="op">/</span><span class="dv">2</span>)) <span class="co"># n is the simulation sample size</span></span></code></pre></div>
<ul>
<li>Check whether marginal exchangeability holds for the natural version of treatment <code>A</code>. Repeat for the randomized version of treatment <code>A_rand</code>.</li>
</ul>
<p>Summarize what you learn from these investigations.</p>
<!-- Future: Provide code for marginally randomized and conditionally randomized. Compare balance on Z between treatment groups in the marginally randomized and conditionally randomized settings. -->
<!-- ### Reflection on article and tweet {-}

How racial discrimination in law enforcement actually works
Miguel's tweet: It ain't race but racism

 -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="homework-4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="final-reflection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
